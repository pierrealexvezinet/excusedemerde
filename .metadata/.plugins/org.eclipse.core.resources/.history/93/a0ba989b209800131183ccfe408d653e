package fr.edm.adapter;

import java.util.ArrayList;
import fr.activity.edm.R;
import fr.edm.model.PostEdm;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

public class PostEdmAdapter extends ArrayAdapter<PostEdm> implements OnClickListener {

	private LayoutInflater mInflater = null;
	public PostEdm storage = new PostEdm();
	StorageEdmRelativeLayoutDatas layoutDatas;
	ArrayList<PostEdm> currentListPost = new ArrayList<PostEdm>();
	int resourceTV =0;
	


	public PostEdmAdapter(Context mContext, int resourceTV) {

		super(mContext, 0);
		mInflater = (LayoutInflater) mContext
				.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
		this.resourceTV = resourceTV;

	}

	@Override
	final public View getView(final int position, View convertView,
			ViewGroup parent) {
        
		
	    layoutDatas = new StorageEdmRelativeLayoutDatas();
		View row = convertView;

		if (row == null) {
			row = mInflater
					.inflate(this.resourceTV, parent, false);
			layoutDatas.postEdm = (TextView) row.findViewById(R.id.tv_edm_post);
			layoutDatas.datePost = (TextView) row.findViewById(R.id.tv_edm_post_date);
			layoutDatas.heurePost = (TextView) row.findViewById(R.id.tv_edm_post_hour);
			layoutDatas.auteur = (TextView) row.findViewById(R.id.tv_edm_post_auteur);
			layoutDatas.likerEdm = (Button) row.findViewById(R.id.bt_valider_edm);
			layoutDatas.likerEdm.setOnClickListener(this);
			
			
			
			
			
			final OnClickListener likeEdm = new View.OnClickListener() {
		    public void onClick(View v) {
		    	
		    	if(v == layoutDatas.likerEdm){
		       
		        	
		        	//GET_NB_LIKE_BY_NUM_EDM
		        
		        	restrictionNbLikeByNumEdm.add(new BasicNameValuePair(ApplicationConstants.NUM_REQUEST, ApplicationConstants.GET_NB_LIKE_BY_NUM_EDM));
		        	restrictionNbLikeByNumEdm.add(new BasicNameValuePair(ApplicationConstants.NUM_EDM, ));
		        	
		        	//nbVote , auteurVote,auteurEdm, numEdm, keyVote
		        	restrictionLikerEdm.add(new BasicNameValuePair(ApplicationConstants.NUM_REQUEST, ApplicationConstants.LIKER_EDM));
					restrictionLikerEdm.add(new BasicNameValuePair(ApplicationConstants.PSEUDO, edm.getPseudo() ));
					restrictionLikerEdm.add(new BasicNameValuePair(ApplicationConstants.VICTIME, edm.getVictime()));
					restrictionLikerEdm.add(new BasicNameValuePair(ApplicationConstants.CATEGORIE,edm.getCategorie()));
					restrictionLikerEdm.add(new BasicNameValuePair(ApplicationConstants.DATE_POST,edm.getDatePost()));
		        
		        	
		        	Toast.makeText(getActivity(), "click", Toast.LENGTH_SHORT).show();
		        }
					
		      
		    	
		    }
		};
			
			

			row.setTag(layoutDatas);
		} else {
			layoutDatas = (StorageEdmRelativeLayoutDatas) row.getTag();
		}

		PostEdm entity = getItem(position);

		
			layoutDatas.postEdm.setText(entity.getPost());
			layoutDatas.datePost.setText("Posté le " + entity.getDatePost());
			layoutDatas.heurePost.setText(" à " + entity.getHeurePost() + " |");
			layoutDatas.auteur.setText(entity.getAuteurPost() + " | ");

		

		return row;
	}

	class StorageEdmRelativeLayoutDatas {

		TextView postEdm, datePost, heurePost, auteur;
		Button likerEdm;

	}

	@Override
	public void onClick(View v) {
		// TODO Auto-generated method stub
	 Toast.makeText(getContext(), "VIEW / " + getPosition(storage),  Toast.LENGTH_SHORT).show();
		
	}

}
